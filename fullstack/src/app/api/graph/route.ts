import { NextRequest } from "next/server";

import {
  ForceGraphParams,
  GraphLink,
  GraphLinkRaw,
  GraphNode,
} from "@/types/graph";
import { fail, ok } from "@/lib/api/response";
import { queryClickhouse } from "@/lib/clickhouse/query";

function buildGraphNodesSQL(params: ForceGraphParams) {
  const {
    token,
    filter_time, // 毫秒时间戳
    filter_followers, // 最小粉丝数
    add_user_list, // array<Int>
    sub_user_list, // array<Int>
    ttl, // 天数
    volatility, // 波动率（-1 ~ 1）
    bubble_num, // 总节点数
    top_ratio, // Top 样本比例（0～1），如 0.3
  } = params;

  // 1) 计算部分数量
  const topCount = Math.ceil(bubble_num * top_ratio);
  const addCount = add_user_list.length;
  const remainCount = bubble_num - topCount - addCount;
  // 根据 volatility 简单分配剩余正负数量
  const posCount = Math.round(remainCount * (0.5 + volatility / 2));
  const negCount = remainCount - posCount;

  // 子列表过滤
  const subFilter =
    sub_user_list.length > 0
      ? `AND author_id NOT IN (${sub_user_list.join(",")})`
      : "";
  // 自定义加入列表
  const addUserFilter =
    add_user_list.length > 0
      ? `WHERE id IN (${add_user_list.join(",")})`
      : "WHERE 1 = 0";

  return `
WITH
  toDateTime(${filter_time} / 1000)                              AS ts,
  ${ttl}                                                        AS ttl_days,
  toDateTime(( ${filter_time} - ttl_days * 86400000 ) / 1000)   AS ts_start

, raw AS (
    SELECT author_id, username, name, followers, CAST(score AS Float32) AS score_metrics, created
    FROM user_graph_detail_score
    WHERE active_type = 'comment'
      AND label = '${token}'
      AND created <= ${filter_time}
      AND created > ${filter_time} - ttl_days * 86400000
      AND followers >= ${filter_followers}
      ${subFilter}
)

, aggregated AS (
    SELECT
      author_id,
      anyLast(username)  AS username,
      anyLast(name)      AS name,
      anyLast(followers) AS followers,
      sum(score_metrics * (1 - age_days/ttl_days))
        / sum(1 - age_days/ttl_days)                     AS score_metrics,
      1 - max(age_days)/ttl_days                         AS opacity
    FROM (
      SELECT *, dateDiff('second', toDateTime(created/1000), ts)/86400.0 AS age_days
      FROM raw
    )
    GROUP BY author_id
)

-- Top 粉丝的大V
, top_users AS (
    SELECT author_id, username, name, followers, score_metrics, opacity
    FROM aggregated
    ORDER BY followers DESC
    LIMIT ${topCount}
)
, top_ids AS (
    SELECT author_id FROM top_users
)

-- 分离正/负情绪
, positive AS (SELECT * FROM aggregated WHERE score_metrics > 0 AND author_id NOT IN (SELECT author_id FROM top_ids))
, negative AS (SELECT * FROM aggregated WHERE score_metrics < 0 AND author_id NOT IN (SELECT author_id FROM top_ids))

-- 剩余部分：按粉丝降序取 posCount、negCount
, sampled_pos AS (
    SELECT author_id, username, name, followers, score_metrics, opacity
    FROM positive
    ORDER BY followers DESC
    LIMIT ${posCount}
)
, sampled_neg AS (
    SELECT author_id, username, name, followers, score_metrics, opacity
    FROM negative
    ORDER BY followers DESC
    LIMIT ${negCount}
)

-- 自定义加入
, add_users AS (
    SELECT id AS author_id, username, name, followers, CAST(0.0 AS Float32) AS score_metrics, 1.0 AS opacity
    FROM user_info
    ${addUserFilter}
)

-- 合并最终结果
SELECT author_id, username, name, followers, score_metrics, opacity FROM top_users
UNION ALL
SELECT author_id, username, name, followers, score_metrics, opacity FROM sampled_pos
UNION ALL
SELECT author_id, username, name, followers, score_metrics, opacity FROM sampled_neg
UNION ALL
SELECT author_id, username, name, followers, score_metrics, opacity FROM add_users;
`;
}

function buildGraphLinksSQL(params: ForceGraphParams) {
  const {
    token,
    filter_time, // 毫秒时间戳
    filter_followers, // 最小粉丝数
    add_user_list, // array<Int>
    sub_user_list, // array<Int>
    ttl, // 天数
    volatility, // 波动率（-1 ~ 1）
    bubble_num, // 总节点数
    top_ratio, // Top 样本比例（0～1），如 0.3
    nodes,
  } = params;
  if (!nodes || nodes.length === 0) {
    throw new Error("nodes is empty");
  }
  const userIds = nodes.map((node) => node.id);
  const userIdsStr = userIds.join(",");
  return `
    WITH
    -- 三种行为的权重，可按需调整
    0.6 AS w_comment,
    0.3 AS w_retweet,
    0.1 AS w_follow

-- 1) 先算出每个方向（A→B）的加权平均分
, ds AS (
    SELECT
        author_id     AS source_id,
        label_user_id AS target_id,
        sum(score *
            CASE active_type
                WHEN 'comment'  THEN w_comment
                WHEN 'retweeted' THEN w_retweet
                WHEN 'follow'    THEN w_follow
                ELSE 0
            END
        )
        /
        sum(
            CASE active_type
                WHEN 'comment'  THEN w_comment
                WHEN 'retweeted' THEN w_retweet
                WHEN 'follow'    THEN w_follow
                ELSE 0
            END
        )                  AS source2target_score
    FROM user_graph_detail_score
    WHERE
        object_type = 'user'
        AND created <= ${filter_time}
        AND created > ${filter_time} - ${ttl} * 86400000
        AND author_id     IN (${userIdsStr})
        AND label_user_id IN (${userIdsStr})
    GROUP BY source_id, target_id
)

-- 2) 对于存在 A→B 记录的行，LEFT JOIN 取出 B→A（如果有）
, directional AS (
    SELECT
        d1.source_id,
        d1.target_id,
        d1.source2target_score,
        d2.source2target_score AS target2source_score
    FROM ds AS d1
    LEFT JOIN ds AS d2
      ON d1.source_id = d2.target_id
     AND d1.target_id = d2.source_id
)

-- 3) 对于只有 B→A 而没有 A→B 的情形，需要补一行 (A,B) 且 A→B=NULL
-- 3) 对于只有 B→A 而没有 A→B 的情形，需要补一行 (A,B) 且 A→B=NULL
, inverse_only AS (
    SELECT
        d2.target_id AS source_id,
        d2.source_id AS target_id,
        CAST(NULL AS Nullable(Float64)) AS source2target_score,
        d2.source2target_score AS target2source_score
    FROM ds AS d2
    LEFT JOIN ds AS d1
      ON d1.source_id = d2.target_id
     AND d1.target_id = d2.source_id
    WHERE d1.source_id IS NULL
)


-- 4) 合并并排序
SELECT source_id, target_id, source2target_score, target2source_score 
FROM directional
WHERE source_id <> target_id
AND source2target_score + target2source_score  > 30
UNION ALL
SELECT source_id, target_id, source2target_score, target2source_score FROM inverse_only
WHERE source_id <> target_id
AND source2target_score + target2source_score  > 30;`;
}

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
    const {
      token,
      filter_time,
      filter_followers,
      add_user_list = [],
      sub_user_list = [],
      ttl = 60,
      volatility,
      bubble_num = 150,
      top_ratio = 0.3,
    } = body;
    const nodesSql = buildGraphNodesSQL({
      token,
      filter_time,
      filter_followers,
      add_user_list,
      sub_user_list,
      ttl,
      volatility,
      bubble_num,
      top_ratio,
    });
    // const rawNodes = await queryClickhouse(nodesSql);

    // const nodes: GraphNode[] = rawNodes.map((row) => ({
    //   ...row,
    //   id: row.author_id.toString(),
    //   followers: Number(row.followers),
    // }));
    // // 计算每个节点的粉丝占比
    // const totalFollowers = nodes.reduce((acc, node) => acc + node.followers, 0);
    // // 判断用户是否为 Top，取粉丝数前 15% 的用户
    // const sorted = [...nodes].sort((a, b) => b.percentage - a.percentage);
    // const topCount = Math.ceil(nodes.length * 0.15);
    // const topIds = new Set(sorted.slice(0, topCount).map((n) => n.id));

    // nodes.forEach((node) => {
    //   node.percentage = (node.followers / totalFollowers) * 100;
    //   node.isTop = topIds.has(node.id);
    // });
    // const linksSql = buildGraphLinksSQL({
    //   token,
    //   filter_time,
    //   filter_followers,
    //   add_user_list,
    //   sub_user_list,
    //   ttl,
    //   volatility,
    //   bubble_num,
    //   top_ratio,
    //   nodes,
    // });
    // const rawLinks: GraphLinkRaw[] = await queryClickhouse(linksSql);
    // const links: GraphLink[] = rawLinks.map((row) => ({
    //   source: row.source_id.toString(),
    //   target: row.target_id.toString(),
    //   source2target_score: Number(row.source2target_score),
    //   target2source_score: Number(row.target2source_score),
    // }));
    const nodes = [
      {
        author_id: "276799677",
        username: "ProfDemirtas",
        name: "Özgür Demirtaş",
        followers: 6267636,
        score_metrics: 4.852847169632603,
        opacity: 0.40418402777777773,
        id: "276799677",
        percentage: 5.3695266616722375,
        isTop: true,
      },
      {
        author_id: "39349894",
        username: "EricTrump",
        name: "Eric Trump",
        followers: 5757593,
        score_metrics: 97.47015035901953,
        opacity: 0.16112326388888887,
        id: "39349894",
        percentage: 4.932569332449657,
        isTop: true,
      },
      {
        author_id: "16827333",
        username: "souljaboy",
        name: "Soulja Boy (Draco)",
        followers: 5379338,
        score_metrics: 40,
        opacity: 0.21918962191358027,
        id: "16827333",
        percentage: 4.608515684884478,
        isTop: true,
      },
      {
        author_id: "911011433147654144",
        username: "TrustWallet",
        name: "Trust Wallet",
        followers: 4270072,
        score_metrics: 72.03979100932048,
        opacity: 0.058092785493827126,
        id: "911011433147654144",
        percentage: 3.6581999100235065,
        isTop: true,
      },
      {
        author_id: "902839045356744704",
        username: "justinsuntron",
        name: "H.E. Justin Sun 🍌",
        followers: 3801956,
        score_metrics: 80,
        opacity: 0.15515856481481483,
        id: "902839045356744704",
        percentage: 3.2571617286812335,
        isTop: true,
      },
      {
        author_id: "1052454006537314306",
        username: "BNBCHAIN",
        name: "BNB Chain",
        followers: 3800955,
        score_metrics: 70,
        opacity: 0.09677604166666665,
        id: "1052454006537314306",
        percentage: 3.2563041651296274,
        isTop: true,
      },
      {
        author_id: "43775786",
        username: "stoolpresidente",
        name: "Dave Portnoy",
        followers: 3677818,
        score_metrics: 50,
        opacity: 0.6542148919753086,
        id: "43775786",
        percentage: 3.1508118543862573,
        isTop: true,
      },
      {
        author_id: "1400391752368992260",
        username: "BinanceWallet",
        name: "Binance Wallet",
        followers: 2889638,
        score_metrics: 75.85760916650015,
        opacity: 0.3287193287037037,
        id: "1400391752368992260",
        percentage: 2.475572653482308,
        isTop: true,
      },
      {
        author_id: "29856819",
        username: "theRealKiyosaki",
        name: "Robert Kiyosaki",
        followers: 2766443,
        score_metrics: 87.85170017501733,
        opacity: 0.02648379629629638,
        id: "29856819",
        percentage: 2.3700306537419418,
        isTop: true,
      },
      {
        author_id: "3376321847",
        username: "iluminatibot",
        name: "illuminatibot",
        followers: 2266413,
        score_metrics: 73.74953115715272,
        opacity: 0.16759760802469137,
        id: "3376321847",
        percentage: 1.9416515301559567,
        isTop: true,
      },
      {
        author_id: "1012436626776174592",
        username: "AirdropDet",
        name: "AirdropDetective",
        followers: 2089351,
        score_metrics: 50.00000000000001,
        opacity: 0.2328883101851852,
        id: "1012436626776174592",
        percentage: 1.7899613028088341,
        isTop: true,
      },
      {
        author_id: "69620713",
        username: "markets",
        name: "Bloomberg Markets",
        followers: 1902225,
        score_metrics: 46.95087827096143,
        opacity: 0.5579498456790124,
        id: "69620713",
        percentage: 1.6296491777760342,
        isTop: true,
      },
      {
        author_id: "1389913567671975937",
        username: "cb_doge",
        name: "DogeDesigner",
        followers: 1367326,
        score_metrics: 85.94520364517793,
        opacity: 0.15421296296296305,
        id: "1389913567671975937",
        percentage: 1.1713975432200678,
        isTop: true,
      },
      {
        author_id: "1137701",
        username: "DavidSacks",
        name: "David Sacks",
        followers: 1350169,
        score_metrics: -30.000000000000004,
        opacity: 0.16150327932098762,
        id: "1137701",
        percentage: 1.1566990238844985,
        isTop: true,
      },
      {
        author_id: "3278906401",
        username: "MetaMask",
        name: "MetaMask.eth 🦊",
        followers: 1346073,
        score_metrics: 70,
        opacity: 0.11067129629629624,
        id: "3278906401",
        percentage: 1.1531899526483564,
        isTop: true,
      },
      {
        author_id: "1697973048018890752",
        username: "CygnusFi",
        name: "Cygnus",
        followers: 1200686,
        score_metrics: 84.99999999999999,
        opacity: 0.0005308641975309003,
        id: "1697973048018890752",
        percentage: 1.0286359146090476,
        isTop: true,
      },
      {
        author_id: "764141902572691456",
        username: "CoinOrbitX",
        name: "CoinOrbitX",
        followers: 1189994,
        score_metrics: 58.2448316279752,
        opacity: 0.06833043981481479,
        id: "764141902572691456",
        percentage: 1.0194760050248597,
        isTop: true,
      },
      {
        author_id: "1265037073",
        username: "RobinhoodApp",
        name: "Robinhood",
        followers: 1174073,
        score_metrics: 82.41465143170953,
        opacity: 0.1927040895061728,
        id: "1265037073",
        percentage: 1.0058363753494153,
        isTop: true,
      },
      {
        author_id: "1313548940944396288",
        username: "PiNewsMedia",
        name: "Pi News",
        followers: 1110967,
        score_metrics: 87.89708858095348,
        opacity: 0.11294540895061733,
        id: "1313548940944396288",
        percentage: 0.9517730332039098,
        isTop: true,
      },
      {
        author_id: "1711819315312480257",
        username: "plumenetwork",
        name: "Plume - RWAfi L1",
        followers: 1084347,
        score_metrics: 76.39235147296917,
        opacity: 0.08352546296296304,
        id: "1711819315312480257",
        percentage: 0.9289674969963644,
        isTop: true,
      },
      {
        author_id: "17351167",
        username: "scottmelker",
        name: "The Wolf Of All Streets",
        followers: 1031556,
        score_metrics: 44.38005362589754,
        opacity: 0.1031722608024691,
        id: "17351167",
        percentage: 0.8837410859545715,
        isTop: true,
      },
      {
        author_id: "1397045616736276480",
        username: "gabrielleydon",
        name: "Gabriel Leydon",
        followers: 1025907,
        score_metrics: 30.80900495765243,
        opacity: 0.07102218364197532,
        id: "1397045616736276480",
        percentage: 0.8789015489885149,
        isTop: true,
      },
      {
        author_id: "1552588328372826113",
        username: "taskonxyz",
        name: "TaskOn | Ultimate Web3 Community Growth Platform",
        followers: 1018662,
        score_metrics: 80,
        opacity: 0.0694369212962963,
        id: "1552588328372826113",
        percentage: 0.8726947078982195,
        isTop: true,
      },
      {
        author_id: "1611184634418823169",
        username: "PolyhedraZK",
        name: "Polyhedra",
        followers: 1010248,
        score_metrics: 70,
        opacity: 0.43566589506172837,
        id: "1611184634418823169",
        percentage: 0.8654863765063979,
        isTop: false,
      },
      {
        author_id: "479204092",
        username: "DianaSanchez_04",
        name: "Diana Sanchez",
        followers: 891689,
        score_metrics: 80.59736848127253,
        opacity: 0.40172453703703703,
        id: "479204092",
        percentage: 0.7639160696983448,
        isTop: false,
      },
      {
        author_id: "3161544841",
        username: "TheCryptoKidsX",
        name: "Mr M.A.D 🇬🇧",
        followers: 882283,
        score_metrics: 75,
        opacity: 0.07259799382716048,
        id: "3161544841",
        percentage: 0.7558578851165202,
        isTop: false,
      },
      {
        author_id: "1592468786489212928",
        username: "Mantle_Official",
        name: "Mantle",
        followers: 875728,
        score_metrics: 75,
        opacity: 0.001482445987654346,
        id: "1592468786489212928",
        percentage: 0.75024217174911,
        isTop: false,
      },
      {
        author_id: "1662304950909796353",
        username: "MorphLayer",
        name: "Morph 🐨",
        followers: 872928,
        score_metrics: 70,
        opacity: 0.4676132330246914,
        id: "1662304950909796353",
        percentage: 0.7478433925837784,
        isTop: false,
      },
      {
        author_id: "887748030304329728",
        username: "TheCryptoDog",
        name: "The Crypto Dog 📈",
        followers: 862828,
        score_metrics: 30.24460610923548,
        opacity: 0.06586168981481477,
        id: "887748030304329728",
        percentage: 0.7391906534516894,
        isTop: false,
      },
      {
        author_id: "1516941936971554817",
        username: "Wolfy_XBT",
        name: "杀破狼 WolfyXBT",
        followers: 821158,
        score_metrics: 89.99999999999999,
        opacity: 0.07919483024691365,
        id: "1516941936971554817",
        percentage: 0.7034916792304867,
        isTop: false,
      },
      {
        author_id: "1531588175000268800",
        username: "AethirCloud",
        name: "Aethir",
        followers: 819515,
        score_metrics: 84.83965217668408,
        opacity: 0.03183699845679011,
        id: "1531588175000268800",
        percentage: 0.702084109884544,
        isTop: false,
      },
      {
        author_id: "1361909631187001350",
        username: "Scroll_ZKP",
        name: "Scroll",
        followers: 813365,
        score_metrics: 75,
        opacity: 0.5242175925925926,
        id: "1361909631187001350",
        percentage: 0.696815362789262,
        isTop: false,
      },
      {
        author_id: "1326658439527936000",
        username: "MantaNetwork",
        name: "Manta Network (🔱,🔱)",
        followers: 789963,
        score_metrics: 74.99999999999999,
        opacity: 0.01851273148148147,
        id: "1326658439527936000",
        percentage: 0.6767667092081584,
        isTop: false,
      },
      {
        author_id: "1515104342906327045",
        username: "SeiNetwork",
        name: "Sei 🔴💨",
        followers: 782277,
        score_metrics: 75,
        opacity: 0.4701743827160494,
        id: "1515104342906327045",
        percentage: 0.6701820603993232,
        isTop: false,
      },
      {
        author_id: "247857712",
        username: "PeterLBrandt",
        name: "Peter Brandt",
        followers: 781646,
        score_metrics: 19.659648343359873,
        opacity: 0.001614969135802502,
        id: "247857712",
        percentage: 0.6696414783802789,
        isTop: false,
      },
      {
        author_id: "952087880918228992",
        username: "JRNYcrypto",
        name: "JRNY Crypto",
        followers: 777606,
        score_metrics: 75.24905572678725,
        opacity: 0.059085455246913554,
        id: "952087880918228992",
        percentage: 0.6661803827274433,
        isTop: false,
      },
      {
        author_id: "2259434528",
        username: "cobie",
        name: "Cobie",
        followers: 771961,
        score_metrics: 70,
        opacity: 0.5327048611111111,
        id: "2259434528",
        percentage: 0.6613442725887658,
        isTop: false,
      },
      {
        author_id: "250980843",
        username: "cameron",
        name: "Cameron Winklevoss",
        followers: 745612,
        score_metrics: 86.67564643080753,
        opacity: 0.17056635802469133,
        id: "250980843",
        percentage: 0.6387709039361508,
        isTop: false,
      },
      {
        author_id: "823766058909761536",
        username: "LynAldenContact",
        name: "Lyn Alden",
        followers: 744237,
        score_metrics: 61.975134679830745,
        opacity: 0.011722415123456731,
        id: "823766058909761536",
        percentage: 0.637592932024604,
        isTop: false,
      },
      {
        author_id: "1693776591808311296",
        username: "Roolznft",
        name: "RoOLZ",
        followers: 735534,
        score_metrics: 50,
        opacity: 0.4535756172839507,
        id: "1693776591808311296",
        percentage: 0.6301370123546466,
        isTop: false,
      },
      {
        author_id: "1393335143188762624",
        username: "layer3xyz",
        name: "Layer3",
        followers: 731175,
        score_metrics: 75,
        opacity: 0.1878815586419752,
        id: "1393335143188762624",
        percentage: 0.6264026272183321,
        isTop: false,
      },
      {
        author_id: "1411205588801908736",
        username: "bitgertbrise",
        name: "Bitgert - $BRISE",
        followers: 729855,
        score_metrics: 70.87745825940179,
        opacity: 0.017781828703703706,
        id: "1411205588801908736",
        percentage: 0.6252717741832472,
        isTop: false,
      },
      {
        author_id: "1395504028910424065",
        username: "LayerZero_Core",
        name: "LayerZero",
        followers: 712369,
        score_metrics: 70,
        opacity: 0.004851851851851885,
        id: "1395504028910424065",
        percentage: 0.6102913982957514,
        isTop: false,
      },
      {
        author_id: "1282418324228337665",
        username: "wsbmod",
        name: "Mod",
        followers: 699826,
        score_metrics: 70,
        opacity: 0.15524922839506172,
        id: "1282418324228337665",
        percentage: 0.5995457243419106,
        isTop: false,
      },
      {
        author_id: "899558268795842561",
        username: "CryptoCred",
        name: "Cred",
        followers: 695349,
        score_metrics: 58.86622621463397,
        opacity: 0.06632581018518524,
        id: "899558268795842561",
        percentage: 0.5957102477979143,
        isTop: false,
      },
      {
        author_id: "15935591",
        username: "CMEGroup",
        name: "CME Group",
        followers: 686371,
        score_metrics: 70,
        opacity: 0.6530248842592592,
        id: "15935591",
        percentage: 0.5880187337456475,
        isTop: false,
      },
      {
        author_id: "1696454329379491840",
        username: "cvex_xyz",
        name: "Crypto Valley Exchange Protocol (CVEX)",
        followers: 663622,
        score_metrics: 61.38570957942313,
        opacity: 0.3190349151234567,
        id: "1696454329379491840",
        percentage: 0.568529509734173,
        isTop: false,
      },
      {
        author_id: "887419466144940032",
        username: "CryptoKemal",
        name: "Crypto Kemal 🥷",
        followers: 658896,
        score_metrics: 48.46663213554227,
        opacity: 0.058358603395061714,
        id: "887419466144940032",
        percentage: 0.5644807131858313,
        isTop: false,
      },
      {
        author_id: "2652239532",
        username: "Ledger",
        name: "Ledger",
        followers: 654291,
        score_metrics: 88.16646590985381,
        opacity: 0.16905054012345688,
        id: "2652239532",
        percentage: 0.5605355781657055,
        isTop: false,
      },
      {
        author_id: "974473136983891968",
        username: "coin98_wallet",
        name: "Coin98 Super Wallet",
        followers: 628367,
        score_metrics: 85,
        opacity: 0.1328518518518519,
        id: "974473136983891968",
        percentage: 0.5383263099221139,
        isTop: false,
      },
      {
        author_id: "66816759",
        username: "RealTristan13",
        name: "Tristan Thompson",
        followers: 624785,
        score_metrics: 86.02034665768373,
        opacity: 0.1879454089506173,
        id: "66816759",
        percentage: 0.535257586004179,
        isTop: false,
      },
      {
        author_id: "1530033576",
        username: "milesdeutscher",
        name: "Miles Deutscher",
        followers: 619514,
        score_metrics: 65.1955004818748,
        opacity: 0.0021230709876542964,
        id: "1530033576",
        percentage: 0.5307418842254423,
        isTop: false,
      },
      {
        author_id: "35749949",
        username: "JoelKatz",
        name: 'David "JoelKatz" Schwartz',
        followers: 613899,
        score_metrics: 55,
        opacity: 0.3457347608024691,
        id: "35749949",
        percentage: 0.5259314752921077,
        isTop: false,
      },
      {
        author_id: "1676195942125522947",
        username: "Sidekick_Labs",
        name: "Sidekick",
        followers: 609272,
        score_metrics: 80.00000000000001,
        opacity: 0.20348958333333333,
        id: "1676195942125522947",
        percentage: 0.5219674927213972,
        isTop: false,
      },
      {
        author_id: "36208197",
        username: "BitTorrent",
        name: "BitTorrent",
        followers: 605208,
        score_metrics: 80,
        opacity: 0.3953016975308642,
        id: "36208197",
        percentage: 0.5184858361042874,
        isTop: false,
      },
      {
        author_id: "1344614912803426305",
        username: "XMaximist",
        name: "MANDO CT",
        followers: 597745,
        score_metrics: 86.17594457659902,
        opacity: 0.013921682098765431,
        id: "1344614912803426305",
        percentage: 0.5120922329218339,
        isTop: false,
      },
      {
        author_id: "1510886940710617091",
        username: "btc_jx",
        name: "静香小姐",
        followers: 586392,
        score_metrics: 83.23746000858941,
        opacity: 0.0037077546296296893,
        id: "1510886940710617091",
        percentage: 0.502366040113259,
        isTop: false,
      },
      {
        author_id: "1062118922147659776",
        username: "injective",
        name: "Injective 🥷",
        followers: 578593,
        score_metrics: 75,
        opacity: 0.33729996141975305,
        id: "1062118922147659776",
        percentage: 0.4956845834309658,
        isTop: false,
      },
      {
        author_id: "2854919253",
        username: "nobrainflip",
        name: "𝗰𝘆𝗰𝗹𝗼𝗽",
        followers: 578090,
        score_metrics: 83.96234073282194,
        opacity: 0.02264429012345681,
        id: "2854919253",
        percentage: 0.4952536598880509,
        isTop: false,
      },
      {
        author_id: "1261335549215989760",
        username: "Polymarket",
        name: "Polymarket",
        followers: 577317,
        score_metrics: 64.84068264306651,
        opacity: 0.07041396604938277,
        id: "1261335549215989760",
        percentage: 0.4945914254970504,
        isTop: false,
      },
      {
        author_id: "1034471966936313858",
        username: "PrimeXBT",
        name: "PrimeXBT",
        followers: 574643,
        score_metrics: 63.7735183911023,
        opacity: 0.003025270061728369,
        id: "1034471966936313858",
        percentage: 0.49230059139415866,
        isTop: false,
      },
      {
        author_id: "1434943688023711746",
        username: "KimaNetwork",
        name: "Kima Network",
        followers: 551260,
        score_metrics: 85.94724348936964,
        opacity: 0.06590914351851862,
        id: "1434943688023711746",
        percentage: 0.47226821524310564,
        isTop: false,
      },
      {
        author_id: "1290284250416242688",
        username: "stevedabitcoin",
        name: "Stevedabitcoin",
        followers: 531094,
        score_metrics: 44.550745409940504,
        opacity: 0.22101620370370367,
        id: "1290284250416242688",
        percentage: 0.45499186501164957,
        isTop: false,
      },
      {
        author_id: "1425834616213020682",
        username: "AITECHio",
        name: "AITECH",
        followers: 521175,
        score_metrics: 88.21005059021924,
        opacity: 0.417021412037037,
        id: "1425834616213020682",
        percentage: 0.4464941898184624,
        isTop: false,
      },
      {
        author_id: "942999039192186882",
        username: "AltcoinPsycho",
        name: "Psycho",
        followers: 518319,
        score_metrics: 40.86151988032956,
        opacity: 0.0576261574074074,
        id: "942999039192186882",
        percentage: 0.44404743506982414,
        isTop: false,
      },
      {
        author_id: "2446024556",
        username: "Tradermayne",
        name: "Mayne",
        followers: 517906,
        score_metrics: 42.36970175215957,
        opacity: 0.05649382716049389,
        id: "2446024556",
        percentage: 0.44369361514293776,
        isTop: false,
      },
      {
        author_id: "2478439963",
        username: "monero",
        name: "Monero (XMR)",
        followers: 509049,
        score_metrics: 70,
        opacity: 0.43969386574074076,
        id: "2478439963",
        percentage: 0.43610576261888706,
        isTop: false,
      },
      {
        author_id: "39257839",
        username: "Benaskren",
        name: "Funky 🇺🇸🇺🇸🇺🇸",
        followers: 508427,
        score_metrics: 77.93420579029083,
        opacity: 0.22738387345679023,
        id: "39257839",
        percentage: 0.4355728909614455,
        isTop: false,
      },
      {
        author_id: "23618940",
        username: "lopp",
        name: "Jameson Lopp",
        followers: 506256,
        score_metrics: 61.7997930051281,
        opacity: 0.051569444444444446,
        id: "23618940",
        percentage: 0.4337129804014688,
        isTop: false,
      },
      {
        author_id: "1426142483822518274",
        username: "BinanceFutures",
        name: "Binance Futures",
        followers: 494849,
        score_metrics: 61.810930816254874,
        opacity: 0.21010821759259257,
        id: "1426142483822518274",
        percentage: 0.42394052542327676,
        isTop: false,
      },
      {
        author_id: "390627208",
        username: "IvanOnTech",
        name: "Ivan on Tech 🚀 Building Moralis",
        followers: 489376,
        score_metrics: 86.77973744971064,
        opacity: 0.15425424382716058,
        id: "390627208",
        percentage: 0.4192517688618983,
        isTop: false,
      },
      {
        author_id: "1557374675583475712",
        username: "MonadPump",
        name: "Monad Pump",
        followers: 482646,
        score_metrics: 60,
        opacity: 0.1395260416666667,
        id: "1557374675583475712",
        percentage: 0.41348613179665483,
        isTop: false,
      },
      {
        author_id: "1171719416389591041",
        username: "Phemex_official",
        name: "Phemex",
        followers: 482354,
        score_metrics: 76.54818029206517,
        opacity: 0.044419560185185114,
        id: "1171719416389591041",
        percentage: 0.4132359733979845,
        isTop: false,
      },
      {
        author_id: "1315920782065766400",
        username: "impossiblefi",
        name: "Impossible Finance",
        followers: 470512,
        score_metrics: 50.147673124278256,
        opacity: 0.05513310185185183,
        id: "1315920782065766400",
        percentage: 0.40309085094232144,
        isTop: false,
      },
      {
        author_id: "1565719999888736259",
        username: "GalacticaNet",
        name: "Galactica.com",
        followers: 461326,
        score_metrics: 63.93288308374658,
        opacity: 0.20314023919753088,
        id: "1565719999888736259",
        percentage: 0.3952211418663442,
        isTop: false,
      },
      {
        author_id: "1741557908226359296",
        username: "nubit_org",
        name: "Nubit | Bitcoin Thunderbolt",
        followers: 461065,
        score_metrics: 77.7149065942937,
        opacity: 0.036559220679012294,
        id: "1741557908226359296",
        percentage: 0.3949975413798616,
        isTop: false,
      },
      {
        author_id: "1069370594813190145",
        username: "TheBullduck",
        name: "Efe Bulduk",
        followers: 458770,
        score_metrics: 40,
        opacity: 0.2415738811728395,
        id: "1069370594813190145",
        percentage: 0.39303139917113444,
        isTop: false,
      },
      {
        author_id: "910170146",
        username: "furrincrypto",
        name: "NotFurr",
        followers: 454258,
        score_metrics: 19.229192982959827,
        opacity: 0.21453047839506179,
        id: "910170146",
        percentage: 0.38916593788757153,
        isTop: false,
      },
      {
        author_id: "2361601055",
        username: "tier10k",
        name: "db",
        followers: 453409,
        score_metrics: 83.34091032178803,
        opacity: 0.22455381944444452,
        id: "2361601055",
        percentage: 0.38843859377636913,
        isTop: false,
      },
      {
        author_id: "1659508706042847234",
        username: "Ventory_gg",
        name: "Ventory 🦠",
        followers: 448312,
        score_metrics: 91.55952974180093,
        opacity: 0.1124043209876543,
        id: "1659508706042847234",
        percentage: 0.3840719589886209,
        isTop: false,
      },
      {
        author_id: "1172038272618393600",
        username: "AstarNetwork",
        name: "Astar Network",
        followers: 446867,
        score_metrics: 90.00000000000001,
        opacity: 0.414137924382716,
        id: "1172038272618393600",
        percentage: 0.38283401759794083,
        isTop: false,
      },
      {
        author_id: "2263196432",
        username: "GeniusPothead",
        name: "Intelligent Stoners™ 💹🧲",
        followers: 442937,
        score_metrics: 87.58135595417637,
        opacity: 0.10796604938271603,
        id: "2263196432",
        percentage: 0.379467159698029,
        isTop: false,
      },
      {
        author_id: "905395394",
        username: "AndreCronjeTech",
        name: "Andre Cronje",
        followers: 439780,
        score_metrics: 70.50463411002752,
        opacity: 0.019683834876543238,
        id: "905395394",
        percentage: 0.37676253618911765,
        isTop: false,
      },
      {
        author_id: "898917341051965441",
        username: "hedera",
        name: "Hedera",
        followers: 433633,
        score_metrics: 50,
        opacity: 0.6380470679012346,
        id: "898917341051965441",
        percentage: 0.37149635921436996,
        isTop: false,
      },
      {
        author_id: "183951857",
        username: "EmperorBTC",
        name: "Emperor👑",
        followers: 427077,
        score_metrics: 36.427665928321034,
        opacity: 0.3167791280864197,
        id: "183951857",
        percentage: 0.36587978914011504,
        isTop: false,
      },
      {
        author_id: "1553958549230743553",
        username: "CetusProtocol",
        name: "Cetus🐳",
        followers: 426728,
        score_metrics: 90,
        opacity: 0.2194683641975309,
        id: "1553958549230743553",
        percentage: 0.3655807984512933,
        isTop: false,
      },
      {
        author_id: "1355945100216573952",
        username: "dogeofficialceo",
        name: "Sir Doge of the Coin ⚔️",
        followers: 410542,
        score_metrics: 61.80561901132563,
        opacity: 0.05751195987654312,
        id: "1355945100216573952",
        percentage: 0.3517141414619872,
        isTop: false,
      },
      {
        author_id: "2754844977",
        username: "Owlto_Finance",
        name: "Owlto Finance(🦉💛🦉)",
        followers: 407563,
        score_metrics: 80,
        opacity: 0.3317152777777779,
        id: "2754844977",
        percentage: 0.34916201177144335,
        isTop: false,
      },
      {
        author_id: "1624782436138643456",
        username: "bonus_block",
        name: "Block Agent",
        followers: 407472,
        score_metrics: 70,
        opacity: 0.35718518518518527,
        id: "1624782436138643456",
        percentage: 0.34908405144857,
        isTop: false,
      },
      {
        author_id: "1003840309166366721",
        username: "heyibinance",
        name: "Yi He",
        followers: 403543,
        score_metrics: 58.499096455055714,
        opacity: 0.18825482253086412,
        id: "1003840309166366721",
        percentage: 0.34571805025550295,
        isTop: false,
      },
      {
        author_id: "2992350224",
        username: "hstyagi",
        name: "Himanshu Tyagi",
        followers: 401285,
        score_metrics: 18.796588140578706,
        opacity: 0.11218441358024689,
        id: "2992350224",
        percentage: 0.343783606200032,
        isTop: false,
      },
      {
        author_id: "1306359926164516864",
        username: "WOLF_Financial",
        name: "WOLF",
        followers: 395759,
        score_metrics: 78.04648798182758,
        opacity: 0.0179000771604938,
        id: "1306359926164516864",
        percentage: 0.3390494441758811,
        isTop: false,
      },
      {
        author_id: "1840414425003556864",
        username: "hippo_cto",
        name: "Hippo_CTO",
        followers: 394466,
        score_metrics: 50,
        opacity: 0.6354220679012346,
        id: "1840414425003556864",
        percentage: 0.33794172222560476,
        isTop: false,
      },
      {
        author_id: "1079853966681346048",
        username: "JohnEDeaton1",
        name: "John E Deaton",
        followers: 393556,
        score_metrics: 88.60322696665585,
        opacity: 0.005715277777777805,
        id: "1079853966681346048",
        percentage: 0.337162118996872,
        isTop: false,
      },
      {
        author_id: "1358454920299433985",
        username: "RaydiumProtocol",
        name: "Raydium",
        followers: 393178,
        score_metrics: 80,
        opacity: 0.5807984182098765,
        id: "1358454920299433985",
        percentage: 0.3368382838095523,
        isTop: false,
      },
      {
        author_id: "230206137",
        username: "MuroCrypto",
        name: "Muro",
        followers: 392637,
        score_metrics: 63.42160251238771,
        opacity: 0.19894483024691356,
        id: "230206137",
        percentage: 0.3363748054065364,
        isTop: false,
      },
      {
        author_id: "1346047679260893184",
        username: "SynFuturesDefi",
        name: "SynFutures",
        followers: 388867,
        score_metrics: 75,
        opacity: 0.07074845679012354,
        id: "1346047679260893184",
        percentage: 0.33314502060178636,
        isTop: false,
      },
      {
        author_id: "1355014327988707329",
        username: "JakeGagain",
        name: "JAKE",
        followers: 387118,
        score_metrics: 87.88951732822991,
        opacity: 0.07437056327160496,
        id: "1355014327988707329",
        percentage: 0.3316466403302989,
        isTop: false,
      },
      {
        author_id: "1006055524666826754",
        username: "harmonyprotocol",
        name: "Harmony 💙",
        followers: 385650,
        score_metrics: 60,
        opacity: 0.6088861882716049,
        id: "1006055524666826754",
        percentage: 0.3303889946821893,
        isTop: false,
      },
      {
        author_id: "1388488261132238849",
        username: "CESS_Storage",
        name: "CESS Network",
        followers: 383273,
        score_metrics: 80,
        opacity: 0.06860532407407405,
        id: "1388488261132238849",
        percentage: 0.3283526025121917,
        isTop: false,
      },
      {
        author_id: "93408906",
        username: "kerimcalender",
        name: "Kerim Kalender",
        followers: 382305,
        score_metrics: 56.74177950256757,
        opacity: 0.05166435185185181,
        id: "93408906",
        percentage: 0.3275233102864628,
        isTop: false,
      },
      {
        author_id: "928060984379441152",
        username: "shahh",
        name: "shah",
        followers: 381332,
        score_metrics: 71.59014531019587,
        opacity: 0.10510879629629633,
        id: "928060984379441152",
        percentage: 0.32668973452651007,
        isTop: false,
      },
      {
        author_id: "1380341547154083844",
        username: "LFJ_gg",
        name: "LFJ.gg",
        followers: 378643,
        score_metrics: 77.7698080999563,
        opacity: 0.09033159722222228,
        id: "1380341547154083844",
        percentage: 0.324386049820947,
        isTop: false,
      },
      {
        author_id: "2320755170",
        username: "RealVision",
        name: "Real Vision",
        followers: 378284,
        score_metrics: 69.49021811724432,
        opacity: 0.02562885802469128,
        id: "2320755170",
        percentage: 0.32407849206367767,
        isTop: false,
      },
      {
        author_id: "930453075457921029",
        username: "RippleXrpie",
        name: "JackTheRippler ©️",
        followers: 377469,
        score_metrics: 67.48584403725502,
        opacity: 0.1929353780864197,
        id: "930453075457921029",
        percentage: 0.3233802759851972,
        isTop: false,
      },
      {
        author_id: "1962290894",
        username: "cryptocevo",
        name: "cevo",
        followers: 373134,
        score_metrics: 71.94833373676562,
        opacity: 0.0018069058641975166,
        id: "1962290894",
        percentage: 0.31966645181315706,
        isTop: false,
      },
      {
        author_id: "1752018969840480256",
        username: "CryptoAutos_",
        name: "CryptoAutos",
        followers: 370429,
        score_metrics: 85,
        opacity: 0.6037083333333333,
        id: "1752018969840480256",
        percentage: 0.3173490597980778,
        isTop: false,
      },
      {
        author_id: "1392385621243535361",
        username: "RichQuack",
        name: "RichQUACK",
        followers: 366113,
        score_metrics: 48.858144629961785,
        opacity: 0.05191782407407408,
        id: "1392385621243535361",
        percentage: 0.31365151305608807,
        isTop: false,
      },
      {
        author_id: "766578266",
        username: "lowkeyrich_",
        name: "Crypto Messiah",
        followers: 361962,
        score_metrics: 60.370347612518465,
        opacity: 0.15637152777777774,
        id: "766578266",
        percentage: 0.310095322943484,
        isTop: false,
      },
      {
        author_id: "948505518535991296",
        username: "Tokocrypto",
        name: "Tokocrypto",
        followers: 360622,
        score_metrics: 69.1723965570967,
        opacity: 0.0005596064814814561,
        id: "948505518535991296",
        percentage: 0.30894733577150385,
        isTop: false,
      },
      {
        author_id: "900935123968737281",
        username: "hebi555",
        name: "何币",
        followers: 360610,
        score_metrics: 9.339886988021295,
        opacity: 0.17911574074074077,
        id: "900935123968737281",
        percentage: 0.30893705528936677,
        isTop: false,
      },
      {
        author_id: "1051852534518824960",
        username: "inversebrah",
        name: "smolting (wassie, verse)",
        followers: 352032,
        score_metrics: 31.15185649228419,
        opacity: 0.0748398919753086,
        id: "1051852534518824960",
        percentage: 0.30158822397500445,
        isTop: false,
      },
      {
        author_id: "1521367307708436481",
        username: "lista_dao",
        name: "Lista DAO",
        followers: 348422,
        score_metrics: 82.21558609713341,
        opacity: 0.09497299382716051,
        id: "1521367307708436481",
        percentage: 0.2984955122654162,
        isTop: false,
      },
      {
        author_id: "1463071986515599362",
        username: "Starknet",
        name: "Starknet 🐺🐱",
        followers: 346334,
        score_metrics: 75.3414912334984,
        opacity: 0.0815007716049383,
        id: "1463071986515599362",
        percentage: 0.2967067083735547,
        isTop: false,
      },
      {
        author_id: "1442753558311424001",
        username: "Mises001",
        name: "Mises",
        followers: 345846,
        score_metrics: 65,
        opacity: 0.33109355709876553,
        id: "1442753558311424001",
        percentage: 0.29628863543331113,
        isTop: false,
      },
      {
        author_id: "21263333",
        username: "jimmysong",
        name: "Jimmy Song (송재준)",
        followers: 345771,
        score_metrics: 77.34585675174131,
        opacity: 0.03814062500000004,
        id: "21263333",
        percentage: 0.296224382419954,
        isTop: false,
      },
      {
        author_id: "14654494",
        username: "Excellion",
        name: "Samson Mow",
        followers: 340135,
        score_metrics: 86.2244959851066,
        opacity: 0.05841493055555558,
        id: "14654494",
        percentage: 0.29139598264287947,
        isTop: false,
      },
      {
        author_id: "1232319080637616128",
        username: "CertiKCommunity",
        name: "CertiK Skynet Rating",
        followers: 338660,
        score_metrics: 85.00000000000001,
        opacity: 0.10826967592592596,
        id: "1232319080637616128",
        percentage: 0.2901323400468565,
        isTop: false,
      },
      {
        author_id: "209002536",
        username: "TekinogluDogu",
        name: "Doğu Tekinoğlu",
        followers: 336485,
        score_metrics: 72.20444494436957,
        opacity: 0.001245177469135772,
        id: "209002536",
        percentage: 0.2882690026595008,
        isTop: false,
      },
      {
        author_id: "1297503202464718850",
        username: "bull_bnb",
        name: "Bull.BnB",
        followers: 457070,
        score_metrics: -10.72730930174141,
        opacity: 0.38754899691358025,
        id: "1297503202464718850",
        percentage: 0.39157499753504027,
        isTop: false,
      },
      {
        author_id: "991345218678116353",
        username: "digitalassetbuy",
        name: "Digital Asset Investor",
        followers: 434283,
        score_metrics: -43.03828159870571,
        opacity: 0.17061940586419755,
        id: "991345218678116353",
        percentage: 0.37205321866346486,
        isTop: false,
      },
      {
        author_id: "1364818198416171011",
        username: "BSCS_Global",
        name: "BSCS Official",
        followers: 411603,
        score_metrics: -5.678053446751579,
        opacity: 0.13294386574074069,
        id: "1364818198416171011",
        percentage: 0.35262310742427894,
        isTop: false,
      },
      {
        author_id: "1343224146658914304",
        username: "crypto_bitlord7",
        name: "Crypto Bitlord",
        followers: 410704,
        score_metrics: -53.88706020072035,
        opacity: 0.064453125,
        id: "1343224146658914304",
        percentage: 0.3518529279708385,
        isTop: false,
      },
      {
        author_id: "1306070606056546305",
        username: "bcgame",
        name: "BC.GAME",
        followers: 357436,
        score_metrics: -30,
        opacity: 0.11862326388888889,
        id: "1306070606056546305",
        percentage: 0.30621786776409443,
        isTop: false,
      },
      {
        author_id: "1509316111103406082",
        username: "LunaClassicHQ",
        name: "LunaClassic 🟨 ™",
        followers: 349595,
        score_metrics: -20.961291946785188,
        opacity: 0.29617033179012353,
        id: "1509316111103406082",
        percentage: 0.2995004293943212,
        isTop: false,
      },
      {
        author_id: "1311393885806100481",
        username: "gmoneyNFT",
        name: "gmoney.9dcc.e τh",
        followers: 315734,
        score_metrics: -50,
        opacity: 0.3614670138888889,
        id: "1311393885806100481",
        percentage: 0.27049147892385933,
        isTop: false,
      },
      {
        author_id: "1829498397184946176",
        username: "liangxihuigui",
        name: "凉兮大元帅（白虎）",
        followers: 270984,
        score_metrics: -21.351972225752544,
        opacity: 0.11251716820987656,
        id: "1829498397184946176",
        percentage: 0.2321538476207919,
        isTop: false,
      },
      {
        author_id: "1100932506193260544",
        username: "benbybit",
        name: "Ben Zhou",
        followers: 270358,
        score_metrics: -79.86810366885409,
        opacity: 0.014388503086419702,
        id: "1100932506193260544",
        percentage: 0.2316175491359713,
        isTop: false,
      },
      {
        author_id: "1392124029914566666",
        username: "metaversejoji",
        name: "joji",
        followers: 258821,
        score_metrics: -5.39575149253122,
        opacity: 0.17247183641975306,
        id: "1392124029914566666",
        percentage: 0.22173372226796037,
        isTop: false,
      },
      {
        author_id: "1495753412620787719",
        username: "Nightly_app",
        name: "Nightly",
        followers: 246759,
        score_metrics: -47.60042123590115,
        opacity: 0.0026390817901233987,
        id: "1495753412620787719",
        percentage: 0.21140012430644978,
        isTop: false,
      },
      {
        author_id: "814264532419969026",
        username: "farmercist_eth",
        name: "Farmercist 👨‍🌾",
        followers: 244255,
        score_metrics: -10,
        opacity: 0.018010609567901237,
        id: "814264532419969026",
        percentage: 0.2092549303671675,
        isTop: false,
      },
      {
        author_id: "1636021461147344904",
        username: "BRKTgg",
        name: "BRKT 👑",
        followers: 243599,
        score_metrics: -7.6337147627934385,
        opacity: 0.1858885030864197,
        id: "1636021461147344904",
        percentage: 0.20869293067700412,
        isTop: false,
      },
      {
        author_id: "828315301183909889",
        username: "earnwithsapna",
        name: "Sapna Singh",
        followers: 234348,
        score_metrics: -43.60903674669446,
        opacity: 0.23062056327160496,
        id: "828315301183909889",
        percentage: 0.20076753565611746,
        isTop: false,
      },
      {
        author_id: "116328126",
        username: "adamscochran",
        name: "Adam Cochran (adamscochran.eth)",
        followers: 223873,
        score_metrics: -4.14872858639001,
        opacity: 0.15335435956790122,
        id: "116328126",
        percentage: 0.191793531457243,
        isTop: false,
      },
      {
        author_id: "1357259205191766016",
        username: "BentoBoiNFT",
        name: "BentoBoi",
        followers: 219661,
        score_metrics: -70,
        opacity: 0.2264762731481481,
        id: "1357259205191766016",
        percentage: 0.18818508222710847,
        isTop: false,
      },
      {
        author_id: "1078362309687472134",
        username: "devchart",
        name: "Devchart 👨🏻‍💻",
        followers: 199663,
        score_metrics: -18.798252946403334,
        opacity: 0.007308256172839478,
        id: "1078362309687472134",
        percentage: 0.17105265874557232,
        isTop: false,
      },
      {
        author_id: "2433432126",
        username: "Cryptopathic",
        name: "path.eth 🛡️",
        followers: 187958,
        score_metrics: -53.93709087579067,
        opacity: 0.22723804012345672,
        id: "2433432126",
        percentage: 0.16102490512764148,
        isTop: false,
      },
      {
        author_id: "1341796696867491841",
        username: "RealCryptoFace1",
        name: "CryptoFace",
        followers: 185524,
        score_metrics: -5.144120332753051,
        opacity: 0.05968344907407408,
        id: "1341796696867491841",
        percentage: 0.1589396806674925,
        isTop: false,
      },
      {
        author_id: "947567484533596160",
        username: "Cobb_XRPL",
        name: "Cobb",
        followers: 181498,
        score_metrics: -39.4583157384815,
        opacity: 0.04386747685185177,
        id: "947567484533596160",
        percentage: 0.15549057891048357,
        isTop: false,
      },
      {
        author_id: "1346599984528023554",
        username: "KeyboardMonkey3",
        name: "Keyboard Monkey -KBM-",
        followers: 176477,
        score_metrics: -48.43899605151427,
        opacity: 0.05285667438271602,
        id: "1346599984528023554",
        percentage: 0.15118905384293718,
        isTop: false,
      },
      {
        author_id: "1745026131911376896",
        username: "blockstreetGL",
        name: "blockstreet",
        followers: 162683,
        score_metrics: -23.18460607982423,
        opacity: 0.0989168595679012,
        id: "1745026131911376896",
        percentage: 0.13937163962630003,
        isTop: false,
      },
      {
        author_id: "23687471",
        username: "mattmedved",
        name: "medved",
        followers: 158199,
        score_metrics: -10,
        opacity: 0.11553433641975308,
        id: "23687471",
        percentage: 0.13553016613439042,
        isTop: false,
      },
      {
        author_id: "2844400678",
        username: "samczsun",
        name: "samczsun",
        followers: 150462,
        score_metrics: -30.000000000000004,
        opacity: 0.0743159722222223,
        id: "2844400678",
        percentage: 0.12890182527647237,
        isTop: false,
      },
      {
        author_id: "1281133175658254336",
        username: "Awawat_Trades",
        name: "Awawat",
        followers: 142127,
        score_metrics: -14.663482049652796,
        opacity: 0.12084915123456785,
        id: "1281133175658254336",
        percentage: 0.12176117372538706,
        isTop: false,
      },
      {
        author_id: "994599742389792768",
        username: "ColeThereum",
        name: "Cole",
        followers: 138145,
        score_metrics: -20,
        opacity: 0.6287930169753086,
        id: "994599742389792768",
        percentage: 0.11834976706954763,
        isTop: false,
      },
      {
        author_id: "314560827",
        username: "DaoKwonDo",
        name: "Books",
        followers: 125510,
        score_metrics: -25.271033136108205,
        opacity: 0.05539718364197532,
        id: "314560827",
        percentage: 0.1075252760859888,
        isTop: false,
      },
      {
        author_id: "1081354216843632640",
        username: "gametheorizing",
        name: "Jordi Alexander",
        followers: 118796,
        score_metrics: -42.40546494525942,
        opacity: 0.17516165123456784,
        id: "1081354216843632640",
        percentage: 0.10177334633026153,
        isTop: false,
      },
      {
        author_id: "1122211825452556288",
        username: "TheShamdoo",
        name: "shamdoo",
        followers: 118229,
        score_metrics: -12.2384103279051,
        opacity: 0.1124511959876543,
        id: "1122211825452556288",
        percentage: 0.10128759354928189,
        isTop: false,
      },
      {
        author_id: "943060751668805633",
        username: "X__Anderson",
        name: "Anders 🏁🌏",
        followers: 117768,
        score_metrics: -24.13105989741837,
        opacity: 0.11430246913580244,
        id: "943060751668805633",
        percentage: 0.10089265169384692,
        isTop: false,
      },
      {
        author_id: "368205513",
        username: "yanbojack",
        name: "杰克船长宏观策略（公众号）",
        followers: 113684,
        score_metrics: -17,
        opacity: 0.060650077160493865,
        id: "368205513",
        percentage: 0.09739386093984184,
        isTop: false,
      },
    ];
    const links = [
      {
        source: "1079853966681346048",
        target: "17351167",
        source2target_score: 30,
        target2source_score: 30,
      },
      {
        source: "902839045356744704",
        target: "17351167",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "1311393885806100481",
        target: "1346599984528023554",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "1281133175658254336",
        target: "1081354216843632640",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "1052454006537314306",
        target: "1003840309166366721",
        source2target_score: 30,
        target2source_score: 30,
      },
      {
        source: "943060751668805633",
        target: "991345218678116353",
        source2target_score: 30,
        target2source_score: 30,
      },
      {
        source: "1051852534518824960",
        target: "1261335549215989760",
        source2target_score: 30,
        target2source_score: 30,
      },
      {
        source: "1315920782065766400",
        target: "911011433147654144",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "1395504028910424065",
        target: "1515104342906327045",
        source2target_score: 30,
        target2source_score: 53.333333333333336,
      },
      {
        source: "1434943688023711746",
        target: "2754844977",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "1137701",
        target: "17351167",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "902839045356744704",
        target: "1100932506193260544",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "1509316111103406082",
        target: "902839045356744704",
        source2target_score: 30,
        target2source_score: 0,
      },
      {
        source: "3278906401",
        target: "1311393885806100481",
        source2target_score: 30,
        target2source_score: 30,
      },
    ];
    return ok({ nodes, links });
  } catch (error: any) {
    console.error("查询失败:", error.message);
    return fail("Query failed");
  }
}
